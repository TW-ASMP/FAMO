# SPARQL 1.2.1 merge reconciliation with operational graph (**for relations - using famo:hasObject only**)
# variable scope for combined query TBD (may need to rename or break cases into individual queries)

PREFIX famo: <http://ontology.eil.utoronto.ca/FAMO/famo/>
PREFIX famo_app: <http://ontology.eil.utoronto.ca/FAMO/famo_hub_application/>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

#case 1a: object not nothing
INSERT {
#new property manifestations
GRAPH <http://www.torontowater.org/asmp/dh/operational/> {
?new_property_id a ?property_type.
?new_property_id famo:hasObject ?new_object;
		famo_app:beginOfExistsAtXSDDateTimeStamp ?t;
		famo:hasSubject ?subject.
#plus other metadata (source project, author, etc)
?proj ?r ?new_property_id;
	famo:invalidates ?current_property_id.
	}
}
WHERE {
#new properties to insert from staging graph
VALUES ?g1 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g1 {
?new_property_id famo:hasObject ?new_object
}

VALUES ?g2 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g2 {
?new_property_id famo:hasSubject ?subject
}

VALUES ?g3 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g3 {
?new_property_id a ?property_type.
}

VALUES ?g4 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g4 {
#need to match the subclass of property manifestation, not just any class that the property is a type of
?property_type rdfs:subClassOf famo:PropertyManifestation.
}

VALUES ?g5 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g5 {
?proj ?r ?new_property_id.
FILTER (?r = famo:leadsToInformation) || (?r = famo:finds))
BIND (NOW() AS ?t)
	}
	
#where there are discrepancies with operational graph
VALUES ?g6 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g6 {
?current_property_id famo:hasObject ?old_object.
 FILTER(?old_object!=?new_object)
}

VALUES ?g7 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g7 {
?current_property_id famo:hasSubject ?subject
}

VALUES ?g8 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g8 {
?current_property_id a ?property_type.
}

VALUES ?g9 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g9 {
?current_property_id a famo:CurrentPropertyManifestation.
}

VALUES ?g10 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g10 {
?property_type rdfs:subClassOf famo:PropertyManifestation.
 }
 
};

#case 1a-2: new object is nothing
INSERT {
#new property manifestations
GRAPH <http://www.torontowater.org/asmp/dh/operational/> {
?new_property_id a ?property_type.
?new_property_id famo_app:beginOfExistsAtXSDDateTimeStamp ?t;
		famo:hasSubject ?subject.
#plus other metadata (source project, author, etc)
?proj ?r ?new_property_id;
	famo:invalidates ?current_property_id.
	}
}
WHERE {
#new properties to insert from staging graph
VALUES ?g1 {<http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g1 {
?new_property_id famo:hasObject famo:nothing.
}

VALUES ?g2 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g2 {
?new_property_id famo:hasSubject ?subject.
}

VALUES ?g3 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g3 {
?new_property_id a ?property_type.
}

VALUES ?g4 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g4 {
#need to match the subclass of property manifestation, not just any class that the property is a type of
?property_type rdfs:subClassOf famo:PropertyManifestation.
}

VALUES ?g5 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g5 {
?proj ?r ?new_property_id.
FILTER (?r = famo:leadsToInformation) || (?r = famo:finds))
BIND (NOW() AS ?t)
	}
	
#where there are discrepancies with operational graph
VALUES ?g6 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g6 {
?current_property_id famo:hasObject ?old_object.
 FILTER(?old_object!= famo:nothing)
}

VALUES ?g7 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g7 {
?current_property_id famo:hasSubject ?subject
}

VALUES ?g8 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g8 {
?current_property_id a ?property_type.
}

VALUES ?g9 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g9 {
?current_property_id a famo:CurrentPropertyManifestation.
}

VALUES ?g10 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g10 {
?property_type rdfs:subClassOf famo:PropertyManifestation.
 }
 
};

#case 1b
INSERT {
#new property manifestations
GRAPH <http://www.torontowater.org/asmp/dh/operational/> {
?new_property_id a ?property_type.
?new_property_id famo:hasObject ?new_object;
		famo_app:beginOfExistsAtXSDDateTimeStamp ?t;
		famo:hasSubject ?subject.
#plus other metadata (source project, author, etc)
?proj famo:finds ?new_property_id;
	famo:invalidates ?current_property_id.
	}
}
WHERE {
#new properties to insert from staging graph
VALUES ?g1 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g1 {
?new_property_id famo:hasObject ?new_object.
}

VALUES ?g2 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g2 {
		?new_property_id famo:hasSubject ?subject.
		}
		
VALUES ?g3 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g3 {
		?new_property_id a ?property_type.
		}

VALUES ?g4 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g4 {		
#need to match the subclass of property manifestation, not just any class that the property is a type of
?property_type rdfs:subClassOf famo:PropertyManifestation.
}

VALUES ?g5 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g5 {		
#where the property was an outcome of a reconciliation activity: finds or leadsToInformation
{
{ ?proj famo:finds ?new_property_id.}
UNION
{ ?proj famo:leadsToInformation ?new_property_id.}
}
BIND (NOW() AS ?t)
	}
	
#where the operational graph does not define an object for the current property (value unknown)
VALUES ?g6 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g6 {
?current_property_id famo:hasSubject ?subject.
		FILTER NOT EXISTS {?current_property_id famo:hasObject ?old_object}
		#Note: to match this condition correctly we may need to create a merge of operational and operational_nothing graphs so that we can place this FILTER in this graph pattern, otherwise there is no graph pattern that this filter can be placed in (we are simply looking for the absence of this pattern in the operational_nothing graph but have nothing else to bind these variables to in the same pattern in the nothing graph)
}

VALUES ?g7 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g7 {
		?current_property_id a ?property_type.
		}
		
VALUES ?g8 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g8 {		
		?current_property_id a famo:CurrentPropertyManifestation.
		}

VALUES ?g9 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g9 {		
?property_type rdfs:subClassOf famo:PropertyManifestation.
	}
 
};

#case 2
INSERT {
#new property manifestations 
GRAPH <http://www.torontowater.org/asmp/dh/operational/> {
#plus other metadata (source project, author, etc)
?proj ?r ?current_property_id.
	}
}
WHERE {
#new properties to insert from staging graph
VALUES ?g1 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
 GRAPH ?g1 {
?new_property_id famo:hasObject ?new_object.}

VALUES ?g2 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
 GRAPH ?g2 {
		?new_property_id famo:hasSubject ?subject.
		}
		
VALUES ?g3 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
 GRAPH ?g3 {
		?new_property_id a ?property_type.
		}
		
VALUES ?g4 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
 GRAPH ?g4 {		
#need to match the subclass of property manifestation, not just any class that the property is a type of
?property_type rdfs:subClassOf famo:PropertyManifestation.
}

VALUES ?g5 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
 GRAPH ?g5 {
#where the property was an outcome of a reconciliation activity: finds or leadsToInformation
?proj ?r ?new_property_id.
FILTER (?r = famo:leadsToInformation) || (?r = famo:finds)
	}
	
#where the value aligns with the operational graph
VALUES ?g6 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
 GRAPH ?g6 {
?current_property_id famo:hasObject ?new_object.
}

VALUES ?g7 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
 GRAPH ?g7 {
		?current_property_id famo:hasSubject ?subject.
		}
		
VALUES ?g8 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g8 {
		?current_property_id a ?property_type.
		}

VALUES ?g9 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g9 {		
		?current_property_id a famo:CurrentPropertyManifestation.
		}
		
VALUES ?g10 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g10 {		
?property_type rdfs:subClassOf famo:PropertyManifestation.
	}

};

#case 3a
INSERT {
GRAPH <http://www.torontowater.org/asmp/dh/operational/> {
#plus other metadata (source project, author, etc)
?proj famo:unableToAccess ?current_property_id.
	}
}
WHERE {
#new properties to insert from staging graph
VALUES ?g1 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g1 {
?new_property_id famo:hasSubject ?subject.
#no object is specified in the staging graph
FILTER NOT EXISTS {?new_property_id famo:hasObject ?new_object}	#another case requiring a merge of the staging and nothing graphs
}

VALUES ?g2 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g2 {
		?new_property_id a ?property_type.}

VALUES ?g3 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g3 {		
#need to match the subclass of property manifestation, not just any class that the property is a type of
?property_type rdfs:subClassOf famo:PropertyManifestation.
}

VALUES ?g4 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g4 {		
#metadata defined in the staging graph
?proj famo:unableToAccess ?new_property_id.
	}
	
#where there is a current property manifestation defined in the operational graph
VALUES ?g5 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g5 {
?current_property_id famo:hasSubject ?subject.}

VALUES ?g6 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g6 {
		?current_property_id a ?property_type.
		}
		
VALUES ?g7 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g7 {
		?current_property_id a famo:CurrentPropertyManifestation.}

VALUES ?g8 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/operational_nothing/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g8 {
?property_type rdfs:subClassOf famo:PropertyManifestation.
	}
};

#case 3b
INSERT {
#new property manifestations with new present-tense relations
GRAPH <http://www.torontowater.org/asmp/dh/operational/> {
#plus other metadata (source project, author, etc)
?proj famo:unableToAccess ?new_property_id.
	}
}
WHERE {
#new properties to insert from staging graph
VALUES ?g1 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g1  {
?new_property_id famo:hasSubject ?subject.
#no object is specified in the staging graph
FILTER NOT EXISTS {?new_property_id famo:hasObject ?new_object} #requires merge of reconciliation_staging and reconciliation_nothing_staging 
}
VALUES ?g2 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g2  {
		?new_property_id a ?property_type.}

VALUES ?g3 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g3 {		
#need to match the subclass of property manifestation, not just any class that the property is a type of
?property_type rdfs:subClassOf famo:PropertyManifestation. }

VALUES ?g4 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g4 {	
#metadata defined in the staging graph
?proj famo:unableToAccess ?new_property_id.
	}
	
#where there is no current property manifestation defined in the operational graph
VALUES ?g5 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g5 {
FILTER NOT EXISTS {?current_property_id famo:hasSubject ?subject;			# requires merge of ontology with operational graph 
		a ?property_type;
		a famo:CurrentPropertyManifestation.}
	}
};

#update in progress - need to write additional cases for famo:nothing
#case 5a
INSERT {
#new property manifestations
GRAPH <http://www.torontowater.org/asmp/dh/operational/> {
?new_property_id a ?property_type.
?new_property_id famo:hasObject ?new_object;
		famo:hasSubject ?subject.
#plus other metadata (source project, author, etc)
?proj ?r ?new_property_id.
	}
}
WHERE {
#new properties to insert from staging graph
VALUES ?g1 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g1 {
?new_property_id famo:hasObject ?new_object.}

VALUES ?g2 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g2 {
		?new_property_id famo:hasSubject ?subject.}
		
VALUES ?g3 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g3 {		
		?new_property_id a ?property_type.}
		
VALUES ?g4 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g4 {
#need to match the subclass of property manifestation, not just any class that the property is a type of
?property_type rdfs:subClassOf famo:PropertyManifestation.}

VALUES ?g5 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g5 {
#where the property was an outcome of a reconciliation activity: finds or leadsToInformation
?proj ?r ?new_property_id.
FILTER (?r == famo:leadsToInformation) || (?r == famo:finds))
	}
	
#where there is no current property in the operational graph 
#requires a merge of ontology with operational graph
VALUES ?g6 {<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g6 {
?property_type rdfs:subClassOf famo:PropertyManifestation.
FILTER NOT EXISTS {?current_property_id famo:hasSubject ?subject;
		a ?property_type;
		a famo:CurrentPropertyManifestation.}
	}

};

#case 5b
INSERT {
#new property manifestations
GRAPH <http://www.torontowater.org/asmp/dh/operational/> {
?new_property_id a ?property_type.
?new_property_id famo:hasSubject ?subject.
#plus other metadata (source project, author, etc)
?proj ?r ?new_property_id.
	}
}
WHERE {
#new properties to insert from staging graph
VALUES ?g1 {<http://www.torontowater.org/asmp/dh/reconciliation_nothing_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g1 {
?new_property_id famo:hasObject famo:nothing.}

VALUES ?g2 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g2 {
		?new_property_id famo:hasSubject ?subject.}

VALUES ?g3 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g3 {		
		?new_property_id a ?property_type.}
		
VALUES ?g4 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g4 {	
#need to match the subclass of property manifestation, not just any class that the property is a type of
?property_type rdfs:subClassOf famo:PropertyManifestation.}

VALUES ?g5 {<http://www.torontowater.org/asmp/dh/reconciliation_staging/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g5 {	
#where the property was an outcome of a reconciliation activity: finds or leadsToInformation
?proj ?r ?new_property_id.
FILTER (?r == famo:leadsToInformation) || (?r == famo:finds))	}

#where there is no current property in the operational graph
#requires a merge of operational graph with the ontology
VALUES ?g6{<http://www.torontowater.org/asmp/dh/operational/> <http://www.torontowater.org/asmp/dh/ontology/>}
GRAPH ?g6 {
?property_type rdfs:subClassOf famo:PropertyManifestation.
FILTER NOT EXISTS {?current_property_id famo:hasSubject ?subject;
		a ?property_type;
		a famo:CurrentPropertyManifestation.}
	}
}